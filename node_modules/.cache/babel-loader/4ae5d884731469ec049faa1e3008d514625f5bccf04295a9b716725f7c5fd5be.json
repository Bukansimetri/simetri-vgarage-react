{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Link,useNavigate}from'react-router-dom';import{jwtDecode}from'jwt-decode';import axios from'axios';import'./Dashboard.css';import'./Backgrounds.css';// Import the CSS file for backgrounds\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Dashboard(){const[vehicles,setVehicles]=useState([]);const[notifications,setNotifications]=useState([]);const[notifIndex,setNotifIndex]=useState(0);const navigate=useNavigate();// Check login state on mount and fetch vehicles\nuseEffect(()=>{const token=localStorage.getItem('token');if(!token){navigate('/login');return;}try{const decoded=jwtDecode(token);const now=Date.now()/1000;if(decoded.exp<now){localStorage.removeItem('token');localStorage.removeItem('isLoggedIn');navigate('/login');return;}// Fetch vehicles for this user\nfetch('http://localhost:5000/api/vehicles',{headers:{'Authorization':`Bearer ${token}`}}).then(res=>res.json()).then(data=>{setVehicles(data);// Notification logic for every vehicle\nconst notifs=[];const currentYear=new Date().getFullYear();data.forEach(vehicle=>{// Service notification logic (existing)\nconst last_service_km=Number(vehicle.last_service_km);const service_interval_km=Number(vehicle.service_interval_km);const current_km=Number(vehicle.current_mileage);if(!isNaN(last_service_km)&&last_service_km>0&&!isNaN(service_interval_km)&&service_interval_km>0){const next_service_km=last_service_km+service_interval_km;const diff=current_km-next_service_km;if(!isNaN(current_km)&&(diff>0&&diff<=200||diff<0&&diff>=-200)){notifs.push({id:vehicle.id+'-service',name:vehicle.name,diff,message:diff>0?`Reminder: Vehicle Service for ${vehicle.name} is overdue!`:`Reminder: Vehicle Service for ${vehicle.name} is due in ${Math.abs(diff)} KM!`,distance:Math.abs(diff)});}}// Pajak due notification logic (NEW)\nif(vehicle.pajak_due){const pajakYear=new Date(vehicle.pajak_due).getFullYear();if(pajakYear===currentYear){notifs.push({id:vehicle.id+'-pajak',name:vehicle.name,diff:null,message:`Reminder: Vehicle Tax ${vehicle.name} is due this year (${vehicle.pajak_due.slice(0,10)})!`,distance:null});}}});setNotifications(notifs);setNotifIndex(0);// Reset to first notification\n}).catch(()=>setVehicles([]));}catch(err){localStorage.removeItem('token');localStorage.removeItem('isLoggedIn');navigate('/login');}},[navigate]);const handleNextNotification=()=>{if(notifIndex<notifications.length-1){setNotifIndex(notifIndex+1);}else{setNotifications([]);setNotifIndex(0);}// Only send notificationText\nnotifyUser(' ');};const handleCloseNotification=()=>{if(notifications.length>0&&notifications[notifIndex]){const notif=notifications[notifIndex];const vehicleId=notif.id.split('-')[0];const notificationType=notif.id.split('-')[1];updateVehicleOnNotification(vehicleId,notificationType);}if(notifIndex<notifications.length-1){setNotifIndex(notifIndex+1);}else{setNotifications([]);setNotifIndex(0);}};const notifyUser=async notificationText=>{try{const token=localStorage.getItem('token');const response=await fetch('http://localhost:5000/api/notify',{method:'POST',headers:{'Content-Type':'application/json','Authorization':`Bearer ${token}`},body:JSON.stringify({notificationText})});const data=await response.json();if(!response.ok){alert('Failed: '+data.message+'\\nError: '+data.error);}else{// Optionally, you can remove this alert to avoid spamming the user\n// alert('Notification and email sent!');\n}}catch(err){alert('Error: '+err.message);}};// Update vehicle data when a notification is sent\nconst updateVehicleOnNotification=async(vehicleId,notificationType)=>{const token=localStorage.getItem('token');const vehicle=vehicles.find(v=>String(v.id)===String(vehicleId));if(!vehicle)return;let updateBody={};if(notificationType==='service'){// Set last_service_km to current_mileage\nupdateBody.last_service_km=vehicle.current_mileage;}if(notificationType==='pajak'){// Set pajak_due to next year (or any logic you want)\nconst currentDue=new Date(vehicle.pajak_due);const nextYear=new Date(currentDue.setFullYear(currentDue.getFullYear()+1));updateBody.pajak_due=nextYear.toISOString().slice(0,10);}try{await fetch(`http://localhost:5000/api/vehicles/${vehicleId}`,{method:'PATCH',headers:{'Content-Type':'application/json','Authorization':`Bearer ${token}`},body:JSON.stringify(updateBody)});// Refetch vehicles to update notifications\nfetch('http://localhost:5000/api/vehicles',{headers:{'Authorization':`Bearer ${token}`}}).then(res=>res.json()).then(data=>setVehicles(data));}catch(err){console.error('Failed to update vehicle after notification:',err);}};useEffect(()=>{if(notifications.length>0&&notifications[notifIndex]){notifyUser(notifications[notifIndex].message);}// eslint-disable-next-line\n},[notifications,notifIndex]);return/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard\",children:[notifications.length>0&&notifications[notifIndex]&&/*#__PURE__*/_jsx(\"div\",{className:\"custom-popup-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"custom-popup\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"popup-title\",children:\"NOTIFICATION\"}),/*#__PURE__*/_jsx(\"p\",{className:\"popup-message\",children:notifications[notifIndex].message}),/*#__PURE__*/_jsx(\"div\",{className:\"popup-distance\",children:notifications[notifIndex].distance!==null?`${notifications[notifIndex].distance} KM`:''}),/*#__PURE__*/_jsx(\"div\",{className:\"popup-buttons\",children:/*#__PURE__*/_jsx(\"button\",{className:\"popup-btn\",onClick:handleCloseNotification,children:\"SERVICE DONE\"})})]})},notifications[notifIndex].id),/*#__PURE__*/_jsx(\"h1\",{children:\"Vehicle Overview\"}),/*#__PURE__*/_jsx(\"div\",{className:\"vehicle-list\",children:vehicles.map(vehicle=>{var _vehicle$current_mile;return/*#__PURE__*/_jsx(Link,{to:`/vehicle/${vehicle.id}`,className:\"vehicle-card-link\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"vehicle-card\",children:[/*#__PURE__*/_jsx(\"h3\",{children:vehicle.name}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Mileage: \",(_vehicle$current_mile=vehicle.current_mileage)===null||_vehicle$current_mile===void 0?void 0:_vehicle$current_mile.toLocaleString(),\" km\"]})]})},vehicle.id);})})]});}export default Dashboard;","map":{"version":3,"names":["React","useState","useEffect","Link","useNavigate","jwtDecode","axios","jsx","_jsx","jsxs","_jsxs","Dashboard","vehicles","setVehicles","notifications","setNotifications","notifIndex","setNotifIndex","navigate","token","localStorage","getItem","decoded","now","Date","exp","removeItem","fetch","headers","then","res","json","data","notifs","currentYear","getFullYear","forEach","vehicle","last_service_km","Number","service_interval_km","current_km","current_mileage","isNaN","next_service_km","diff","push","id","name","message","Math","abs","distance","pajak_due","pajakYear","slice","catch","err","handleNextNotification","length","notifyUser","handleCloseNotification","notif","vehicleId","split","notificationType","updateVehicleOnNotification","notificationText","response","method","body","JSON","stringify","ok","alert","error","find","v","String","updateBody","currentDue","nextYear","setFullYear","toISOString","console","className","children","onClick","map","_vehicle$current_mile","to","toLocaleString"],"sources":["/Users/jumratyahmad/Work/Project/web-vgarage-react/src/components/Dashboard.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport { jwtDecode } from 'jwt-decode';\r\nimport axios from 'axios';\r\nimport './Dashboard.css';\r\nimport './Backgrounds.css'; // Import the CSS file for backgrounds\r\n\r\nfunction Dashboard() {\r\n  const [vehicles, setVehicles] = useState([]);\r\n  const [notifications, setNotifications] = useState([]);\r\n  const [notifIndex, setNotifIndex] = useState(0);\r\n  const navigate = useNavigate();\r\n\r\n  // Check login state on mount and fetch vehicles\r\n  useEffect(() => {\r\n    const token = localStorage.getItem('token');\r\n    if (!token) {\r\n      navigate('/login');\r\n      return;\r\n    }\r\n    try {\r\n      const decoded = jwtDecode(token);\r\n      const now = Date.now() / 1000;\r\n      if (decoded.exp < now) {\r\n        localStorage.removeItem('token');\r\n        localStorage.removeItem('isLoggedIn');\r\n        navigate('/login');\r\n        return;\r\n      }\r\n      // Fetch vehicles for this user\r\n      fetch('http://localhost:5000/api/vehicles', {\r\n        headers: {\r\n          'Authorization': `Bearer ${token}`\r\n        }\r\n      })\r\n        .then(res => res.json())\r\n        .then(data => {\r\n          setVehicles(data);\r\n\r\n          // Notification logic for every vehicle\r\n          const notifs = [];\r\n          const currentYear = new Date().getFullYear();\r\n\r\n          data.forEach(vehicle => {\r\n            // Service notification logic (existing)\r\n            const last_service_km = Number(vehicle.last_service_km);\r\n            const service_interval_km = Number(vehicle.service_interval_km);\r\n            const current_km = Number(vehicle.current_mileage);\r\n\r\n            if (\r\n              !isNaN(last_service_km) && last_service_km > 0 &&\r\n              !isNaN(service_interval_km) && service_interval_km > 0\r\n            ) {\r\n              const next_service_km = last_service_km + service_interval_km;\r\n              const diff = current_km - next_service_km;\r\n              if (\r\n                !isNaN(current_km) &&\r\n                ((diff > 0 && diff <= 200) || (diff < 0 && diff >= -200))\r\n              ) {\r\n                notifs.push({\r\n                  id: vehicle.id + '-service',\r\n                  name: vehicle.name,\r\n                  diff,\r\n                  message: diff > 0\r\n                    ? `Reminder: Vehicle Service for ${vehicle.name} is overdue!`\r\n                    : `Reminder: Vehicle Service for ${vehicle.name} is due in ${Math.abs(diff)} KM!`,\r\n                  distance: Math.abs(diff)\r\n                });\r\n              }\r\n            }\r\n\r\n            // Pajak due notification logic (NEW)\r\n            if (vehicle.pajak_due) {\r\n              const pajakYear = new Date(vehicle.pajak_due).getFullYear();\r\n              if (pajakYear === currentYear) {\r\n                notifs.push({\r\n                  id: vehicle.id + '-pajak',\r\n                  name: vehicle.name,\r\n                  diff: null,\r\n                  message: `Reminder: Vehicle Tax ${vehicle.name} is due this year (${vehicle.pajak_due.slice(0, 10)})!`,\r\n                  distance: null\r\n                });\r\n              }\r\n            }\r\n          });\r\n\r\n          setNotifications(notifs);\r\n          setNotifIndex(0); // Reset to first notification\r\n        })\r\n        .catch(() => setVehicles([]));\r\n    } catch (err) {\r\n      localStorage.removeItem('token');\r\n      localStorage.removeItem('isLoggedIn');\r\n      navigate('/login');\r\n    }\r\n  }, [navigate]);\r\n\r\n  const handleNextNotification = () => {\r\n    if (notifIndex < notifications.length - 1) {\r\n      setNotifIndex(notifIndex + 1);\r\n    } else {\r\n      setNotifications([]);\r\n      setNotifIndex(0);\r\n    }\r\n    // Only send notificationText\r\n    notifyUser(' ');\r\n  };\r\n\r\n  const handleCloseNotification = () => {\r\n    if (notifications.length > 0 && notifications[notifIndex]) {\r\n      const notif = notifications[notifIndex];\r\n      const vehicleId = notif.id.split('-')[0];\r\n      const notificationType = notif.id.split('-')[1];\r\n      updateVehicleOnNotification(vehicleId, notificationType);\r\n    }\r\n    if (notifIndex < notifications.length - 1) {\r\n      setNotifIndex(notifIndex + 1);\r\n    } else {\r\n      setNotifications([]);\r\n      setNotifIndex(0);\r\n    }\r\n  };\r\n\r\n  const notifyUser = async (notificationText) => {\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      const response = await fetch('http://localhost:5000/api/notify', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Authorization': `Bearer ${token}`,\r\n        },\r\n        body: JSON.stringify({ notificationText }),\r\n      });\r\n      const data = await response.json();\r\n      if (!response.ok) {\r\n        alert('Failed: ' + data.message + '\\nError: ' + data.error);\r\n      } else {\r\n        // Optionally, you can remove this alert to avoid spamming the user\r\n        // alert('Notification and email sent!');\r\n      }\r\n    } catch (err) {\r\n      alert('Error: ' + err.message);\r\n    }\r\n  };\r\n\r\n  // Update vehicle data when a notification is sent\r\n  const updateVehicleOnNotification = async (vehicleId, notificationType) => {\r\n    const token = localStorage.getItem('token');\r\n    const vehicle = vehicles.find(v => String(v.id) === String(vehicleId));\r\n    if (!vehicle) return;\r\n\r\n    let updateBody = {};\r\n\r\n    if (notificationType === 'service') {\r\n      // Set last_service_km to current_mileage\r\n      updateBody.last_service_km = vehicle.current_mileage;\r\n    }\r\n    if (notificationType === 'pajak') {\r\n      // Set pajak_due to next year (or any logic you want)\r\n      const currentDue = new Date(vehicle.pajak_due);\r\n      const nextYear = new Date(currentDue.setFullYear(currentDue.getFullYear() + 1));\r\n      updateBody.pajak_due = nextYear.toISOString().slice(0, 10);\r\n    }\r\n\r\n    try {\r\n      await fetch(`http://localhost:5000/api/vehicles/${vehicleId}`, {\r\n        method: 'PATCH',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Authorization': `Bearer ${token}`,\r\n        },\r\n        body: JSON.stringify(updateBody),\r\n      });\r\n      // Refetch vehicles to update notifications\r\n      fetch('http://localhost:5000/api/vehicles', {\r\n        headers: { 'Authorization': `Bearer ${token}` }\r\n      })\r\n        .then(res => res.json())\r\n        .then(data => setVehicles(data));\r\n    } catch (err) {\r\n      console.error('Failed to update vehicle after notification:', err);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (notifications.length > 0 && notifications[notifIndex]) {\r\n      notifyUser(notifications[notifIndex].message);\r\n    }\r\n    // eslint-disable-next-line\r\n  }, [notifications, notifIndex]);\r\n\r\n  return (\r\n    <div className=\"dashboard\">\r\n      {notifications.length > 0 && notifications[notifIndex] && (\r\n        <div className=\"custom-popup-overlay\" key={notifications[notifIndex].id}>\r\n          <div className=\"custom-popup\">\r\n            <h1 className=\"popup-title\">NOTIFICATION</h1>\r\n            <p className=\"popup-message\">{notifications[notifIndex].message}</p>\r\n            <div className=\"popup-distance\">\r\n              {notifications[notifIndex].distance !== null ? `${notifications[notifIndex].distance} KM` : ''}\r\n            </div>\r\n            <div className=\"popup-buttons\">\r\n              {/* <button className=\"popup-btn\" onClick={handleNextNotification}>REMIND ME</button> */}\r\n              <button className=\"popup-btn\" onClick={handleCloseNotification}>SERVICE DONE</button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n      <h1>Vehicle Overview</h1>\r\n      <div className=\"vehicle-list\">\r\n        {vehicles.map((vehicle) => (\r\n          <Link key={vehicle.id} to={`/vehicle/${vehicle.id}`} className=\"vehicle-card-link\">\r\n            <div className=\"vehicle-card\">\r\n              <h3>{vehicle.name}</h3>\r\n              <p>Mileage: {vehicle.current_mileage?.toLocaleString()} km</p>\r\n            </div>\r\n          </Link>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Dashboard;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}